# Default shell is fish
set -g default-command fish

# Set keybindings to vi
set-option -g mode-keys vi

set -g automatic-rename off
set -g @tmux_window_name_shells "['bash', 'fish', 'sh', 'zsh']"
set -g @tmux_window_name_programs "['nvim', 'vim', 'vi', 'git']"

# Allow tmux to set the outer terminal (Ghostty tab) title
set-option -g set-titles on
set-option -g set-titles-string '#T'

set-option -g renumber-windows on

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1

set-option -g status-position bottom
set-option -g repeat-time 0
set-option -g status-interval 15

# Removes ESC delay
set -sg escape-time 0

# Mouse disabled â€” use keyboard for everything
set -g mouse off

# True color support
set -as terminal-features ",xterm-ghostty:RGB"
set -as terminal-features ",xterm-256color:RGB"

# Theme
source-file ~/.tmux/themes/modus-operandi.conf

# List of plugins
set -g @tpm_plugins '                   \
    tmux-plugins/tpm                    \
    tmux-plugins/tmux-sensible          \
    tmux-plugins/tmux-pain-control      \
    tmux-plugins/tmux-copycat           \
    tmux-plugins/tmux-yank              \
    tmux-plugins/tmux-open              \
    tmux-plugins/tmux-prefix-highlight  \
    ofirgall/tmux-window-name           \
    accessd/tmux-agent-indicator        \
'

# Agent indicator (Claude session state)
set -g @agent-indicator-border-enabled 'on'
set -g @agent-indicator-indicator-enabled 'on'
set -g @agent-indicator-background-enabled 'off'
set -g @agent-indicator-reset-on-focus 'on'
set -g @agent-indicator-icons 'claude=,default='
set -g @agent-indicator-notification-enabled 'off'
set -g @agent-indicator-processes ''

# Modus Operandi palette
set -g @agent-indicator-needs-input-border '#a60000'
set -g @agent-indicator-needs-input-window-title-bg '#a60000'
set -g @agent-indicator-needs-input-window-title-fg '#ffffff'
set -g @agent-indicator-done-border '#005e00'
set -g @agent-indicator-done-window-title-bg '#005e00'
set -g @agent-indicator-done-window-title-fg '#ffffff'
set -g @agent-indicator-running-border '#0031a9'
set -g @agent-indicator-running-window-title-bg ''
set -g @agent-indicator-running-window-title-fg ''

# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'

# Prefer pane title as window name (Claude Code sets pane title to session name)
set-hook -g pane-title-changed 'rename-window "#{pane_title}"'

# After plugins: override tmux-sensible's default-terminal
set -g default-terminal "tmux-256color"
